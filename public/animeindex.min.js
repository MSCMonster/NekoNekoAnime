let currentPageS=1;let currentPageR=1;let currentPageA=1;function loadMoreAnimes(endpoint,litag,btntag,pageC,datalen,queryarg=""){$.ajax({url:`${endpoint}?page=${pageC}${queryarg}`,method:"GET",success:data=>{data.forEach(anime=>{const formattedDate=formatDate(anime.last_update);const animeDiv=$('<li class="mdui-shadow-5"></li>');animeDiv.append(`<span class="p-img" style="background-image: url(${anime.coverurl})"></span>`);animeDiv.append(`
                <div class="an-info">
                    <div class="an-info-group">
                        <div class="date-text">${formattedDate} 更新</div>
                        <a href="/animeplayer?id=${anime.id}" target="_blank" class="an-text mdui-text-truncate" title="${anime.animename}">${anime.animename}</a>
                    </div> 
                </div>`);animeDiv.click(()=>{window.open(`/animeplayer?id=${anime.id}`,"_blank")});$(litag).append(animeDiv)});if(data.length<datalen){$(btntag).hide()}},error:error=>{console.error(error)}})}$(document).ready(()=>{loadMoreAnimes("/anime-search-r","#r-play","#loadMoreBtn-r",currentPageR,10);loadMoreAnimes("/anime-search-all","#a-play","#loadMoreBtn-a",currentPageA,20)});$("#loadMoreBtn-r").on("click",()=>{currentPageR++;loadMoreAnimes("/anime-search-r","#r-play","#loadMoreBtn-r",currentPageR,10)});$("#loadMoreBtn-a").on("click",()=>{currentPageA++;loadMoreAnimes("/anime-search-all","#a-play","#loadMoreBtn-a",currentPageA,20)});$("#hide-search").on("click",()=>{$("#search-box").hide()});$("#search-btn").on("click",()=>{$("#s-play").empty();const quertStr=`&searchstr=${document.getElementById("search-input").value}&re=${document.getElementById("re").checked}`;loadMoreAnimes("/anime-search-s","#s-play","#loadMoreBtn-s",currentPageS,10,quertStr);$("#search-box").show()});$("#search-input").on("keyup",function(event){if(event.keyCode===13){$("#search-btn").click()}});function formatDate(dateString){const date=new Date(dateString);const year=date.getFullYear();const month=String(date.getMonth()+1).padStart(2,"0");const day=String(date.getDate()).padStart(2,"0");return`${year}/${month}/${day}`}